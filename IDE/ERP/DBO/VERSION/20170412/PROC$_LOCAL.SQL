CREATE OR ALTER PROCEDURE PROC$_LOCAL (
  Q_OBJ_ID TYPE OF COLUMN TABL$_LOCAL.OBJ_ID,
  Q_COL_ID TYPE OF COLUMN TABL$_LOCAL.COL_ID,
  Q_REC_ID TYPE OF COLUMN TABL$_LOCAL.REC_ID = NULL)
RETURNS (
  MESSAGESTR TYPE OF COLUMN TABL$_LOCAL.NAME)
AS
  DECLARE VARIABLE P_COUNTRY_IDS TYPE OF COLUMN TABL$R_COUNTRIES.NAME;
  DECLARE VARIABLE P_COUNTRY_ID  TYPE OF COLUMN TABL$R_COUNTRIES.ID;
BEGIN
  P_COUNTRY_ID = GEN_ID(GENR$R_COUNTRIES_DEFAULT, 0);
  P_COUNTRY_IDS = RDB$GET_CONTEXT('USER_SESSION', 'DATABASE_LOCAL');
  IF( (:P_COUNTRY_IDS IS NOT NULL) AND (TRIM(:P_COUNTRY_IDS) <> '') )THEN
    P_COUNTRY_ID = CAST(:P_COUNTRY_IDS AS INTEGER);

  SELECT FIRST 1 COALESCE(M.NAME, '')
  FROM   TABL$_LOCAL M
  WHERE  ((M.COUNTRY_ID+0) = :P_COUNTRY_ID)
    AND  (M.OBJ_ID   = :Q_OBJ_ID)
    AND  (M.COL_ID   = :Q_COL_ID)
    AND  ( (M.REC_ID = :Q_REC_ID) OR (:Q_REC_ID IS NULL) )
  INTO   :MESSAGESTR;

  SUSPEND;
END
